[gd_scene load_steps=18 format=3 uid="uid://bcaa44w8gvp1x"]

[ext_resource type="Script" path="res://Pan/pan.gd" id="1_756xl"]
[ext_resource type="Texture2D" uid="uid://cpn6bji7dnqda" path="res://Pan/pan_empty.png" id="2_2jk58"]
[ext_resource type="Script" path="res://Common/finite_state_machine.gd" id="3_cq2ji"]
[ext_resource type="PackedScene" uid="uid://c3poo7bdhm2vk" path="res://Ingredients/ingredient_spawner.tscn" id="3_j3iym"]
[ext_resource type="Script" path="res://Pan/empty_state.gd" id="4_mije4"]
[ext_resource type="Script" path="res://Pan/rice_state.gd" id="5_u8dam"]
[ext_resource type="Texture2D" uid="uid://boau8xa4roao7" path="res://Ingredients/Rice/rice_spawner.png" id="6_8jvft"]
[ext_resource type="Script" path="res://Pan/water_state.gd" id="6_a8lel"]
[ext_resource type="Script" path="res://Pan/cooking_state.gd" id="7_o48xl"]
[ext_resource type="Texture2D" uid="uid://cydh3um7bj42j" path="res://Ingredients/Rice/draggable_rice.png" id="7_xkqww"]
[ext_resource type="Script" path="res://Pan/cooked_state.gd" id="8_6b1gn"]
[ext_resource type="Texture2D" uid="uid://d3fdsbiogbah0" path="res://Ingredients/Water/water_spawner.png" id="8_vjguh"]
[ext_resource type="Texture2D" uid="uid://cjmqddcq37cpd" path="res://Ingredients/Water/draggable_water.png" id="9_2cs4m"]
[ext_resource type="Script" path="res://Pan/overcooked_state.gd" id="9_57ch6"]

[sub_resource type="SpriteFrames" id="SpriteFrames_f1rrv"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_2jk58")
}],
"loop": true,
"name": &"STATE_EMPTY",
"speed": 5.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_o6wpb"]
size = Vector2(202, 89)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_prn0a"]
size = Vector2(99, 116)

[node name="Kitchen" type="Node"]

[node name="Stove" type="Node" parent="."]

[node name="Pan" type="Node2D" parent="Stove"]
position = Vector2(200, 500)
script = ExtResource("1_756xl")
pan_name = "rice_pan"
recipes = Array[String](["water", "rice"])

[node name="Timer" type="Timer" parent="Stove/Pan"]
one_shot = true

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="Stove/Pan"]
scale = Vector2(0.5, 0.5)
sprite_frames = SubResource("SpriteFrames_f1rrv")
animation = &"STATE_EMPTY"

[node name="Area2D" type="Area2D" parent="Stove/Pan"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Stove/Pan/Area2D"]
position = Vector2(-40, 1.5)
shape = SubResource("RectangleShape2D_o6wpb")

[node name="FiniteStateMachine" type="Node" parent="Stove/Pan" node_paths=PackedStringArray("state")]
script = ExtResource("3_cq2ji")
state = NodePath("EmptyState")

[node name="EmptyState" type="Node" parent="Stove/Pan/FiniteStateMachine"]
script = ExtResource("4_mije4")

[node name="RiceState" type="Node" parent="Stove/Pan/FiniteStateMachine"]
process_mode = 4
script = ExtResource("5_u8dam")

[node name="WaterState" type="Node" parent="Stove/Pan/FiniteStateMachine"]
process_mode = 4
script = ExtResource("6_a8lel")

[node name="CookingState" type="Node" parent="Stove/Pan/FiniteStateMachine"]
process_mode = 4
script = ExtResource("7_o48xl")
cooking_time = 3.0

[node name="CookedState" type="Node" parent="Stove/Pan/FiniteStateMachine"]
process_mode = 4
script = ExtResource("8_6b1gn")
time_until_overcooked = 3.0

[node name="OvercookedState" type="Node" parent="Stove/Pan/FiniteStateMachine"]
process_mode = 4
script = ExtResource("9_57ch6")

[node name="IngredientSpawners" type="Node" parent="."]

[node name="RiceSpawner" parent="IngredientSpawners" instance=ExtResource("3_j3iym")]
position = Vector2(175, 232)
ingredient_name = "rice"

[node name="Sprite2D" parent="IngredientSpawners/RiceSpawner" index="0"]
scale = Vector2(0.2, 0.2)
texture = ExtResource("6_8jvft")

[node name="CollisionShape2D" parent="IngredientSpawners/RiceSpawner/Area2D" index="0"]
position = Vector2(-1.5, -2)
shape = SubResource("RectangleShape2D_prn0a")

[node name="Sprite2D" parent="IngredientSpawners/RiceSpawner/DraggableIngredient" index="0"]
scale = Vector2(0.446, 0.446)
texture = ExtResource("7_xkqww")

[node name="WaterSpawner" parent="IngredientSpawners" instance=ExtResource("3_j3iym")]
ingredient_name = "water"

[node name="Sprite2D" parent="IngredientSpawners/WaterSpawner" index="0"]
scale = Vector2(0.2, 0.2)
texture = ExtResource("8_vjguh")

[node name="Sprite2D" parent="IngredientSpawners/WaterSpawner/DraggableIngredient" index="0"]
scale = Vector2(0.066, 0.066)
texture = ExtResource("9_2cs4m")

[connection signal="ingredient_released_on_pan" from="Stove/Pan" to="Stove/Pan" method="_on_ingredient_released_on_pan"]
[connection signal="ingredient_released_on_pan" from="Stove/Pan" to="Stove/Pan/FiniteStateMachine/EmptyState" method="_on_pan_ingredient_released"]
[connection signal="timeout" from="Stove/Pan/Timer" to="Stove/Pan/FiniteStateMachine/CookingState" method="_on_timer_timeout"]
[connection signal="area_entered" from="Stove/Pan/Area2D" to="Stove/Pan" method="_on_area_2d_area_entered"]
[connection signal="area_exited" from="Stove/Pan/Area2D" to="Stove/Pan" method="_on_area_2d_area_exited"]
[connection signal="mouse_entered" from="Stove/Pan/Area2D" to="Stove/Pan" method="_on_area_2d_mouse_entered"]
[connection signal="mouse_exited" from="Stove/Pan/Area2D" to="Stove/Pan" method="_on_area_2d_mouse_exited"]
[connection signal="ingredient_released" from="IngredientSpawners/RiceSpawner" to="Stove/Pan" method="_on_ingredient_released"]
[connection signal="ingredient_released" from="IngredientSpawners/WaterSpawner" to="Stove/Pan" method="_on_ingredient_released"]

[editable path="IngredientSpawners/RiceSpawner"]
[editable path="IngredientSpawners/WaterSpawner"]
